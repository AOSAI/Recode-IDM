在 Python 中，类与类之间存在三种关系：依赖关系、组合关系、继承关系。IDM 使用了两种方式去做逆向生成的采样，一种是原始 DDPM，一种是加速采样的 DDIM。

我将两种不同的采样方法，定义在了新类 SamplerDDPM 和 SamplerDDIM 中，并用了组合的方式，将基类 GaussianDiffusion 封装到了两个采样对象的属性中。这样看起来结构清晰，并且未来拓展也变得更容易。

## 1. GaussianDiffusion

在这个基类对象中，我只保留了构造函数（beta 相关计算参数、传入的参数），和扩散、训练相关的函数。一些内容和 DDPM 一致，就不重复讲了，这里仅将不同的地方做一个说明。

### 1.1 q_mean_variance

这个函数是用来计算，在前向加噪过程中，真正的分布的计算。直觉上的理解：均值就是原始图像保留下的部分，方差就是逐步加入的高斯噪声。对比真实后验分布：

- q_mean_variance: 我如何丢失信息”，是可以直接计算出来的，不依赖模型。
- q_posterior: “我如何一步步找回信息”，依赖模型预测的噪声，以及从噪声推断出的 x_0。

### 1.2
